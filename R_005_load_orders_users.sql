insert into  public.users
(
email,
user_id,
phone,
contact_email 
)

select
distinct 
	email,
	user_id,
	phone,
	contact_email
from
	jgali3_assignment_flattern_v;
 


insert into public.orders(
id,
	closed_at,
	created_at,
	updated_at,
	"number",
	note,
	"token",
	gateway,
	test,
	total_price,
	subtotal_price,
	total_weight,
	total_tax,
	taxes_included,
	currency,
	financial_status,
	confirmed,
	total_discounts,
	cart_token,
	buyer_accepts_marketing,
	"name",
	referring_site,
	landing_site,
	cancelled_at,
	cancel_reason,
	total_price_usd,
	checkout_token,
	reference,
	user_id,
	location_id,
	source_identifier,
	source_url,
	processed_at,
	device_id,
	customer_locale,
	app_id,
	browser_ip,
	landing_site_ref,
	order_number,
	processing_method,
	checkout_id,
	source_name,
	fulfillment_status,
	tags,
	order_status_url,
	line_items,
	total_discount,
	load_timestamp
)
select
	id,
	closed_at,
	created_at,
	updated_at,
	"number",
	note,
	"token",
	gateway,
	test,
	total_price,
	subtotal_price,
	total_weight,
	total_tax,
	taxes_included,
	currency,
	financial_status,
	confirmed,
	total_discounts,
	cart_token,
	buyer_accepts_marketing,
	"name",
	referring_site,
	landing_site,
	cancelled_at,
	cancel_reason,
	total_price_usd,
	checkout_token,
	reference,
	user_id,
	location_id,
	source_identifier,
	source_url,
	processed_at,
	device_id,
	customer_locale,
	app_id,
	browser_ip,
	landing_site_ref,
	order_number,
	processing_method,
	checkout_id,
	source_name,
	fulfillment_status,
	tags,
	order_status_url,
	line_items,
	total_discount,
	load_timestamp
from
	jgali3_assignment_flattern_v;
